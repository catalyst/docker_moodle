version: '3'

services:
  moodle:
    build: ./docker/moodle
    ports:
      - "127.0.0.1:80:80"
    volumes:
      - ./siteroot:/siteroot
  db:
    image: mcr.microsoft.com/mssql/server:2017-latest
    environment:
      ACCEPT_EULA: Y
      SA_PASSWORD: Mysecretpassw0rd
      MSSQL_DATA_DIR: /var/lib/mssql
    volumes:
      - 'db:/var/lib/mssql'
      - './db:/db'
  test-db:
    image: mcr.microsoft.com/mssql/server:2017-latest
    environment:
      ACCEPT_EULA: Y
      SA_PASSWORD: Mysecretpassw0rd
      MSSQL_DATA_DIR: /var/lib/mssql
    volumes:
      - 'testdb:/var/lib/mssql'
      - './db:/db'
volumes:
    db:
    testdb: